<?php

/*
 * This file is part of the umulmrum/holiday package.
 *
 * (c) 2016 Stefan Kruppa
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

namespace umulmrum\Holiday\Calculator;

use umulmrum\Holiday\Provider\Germany\BadenWuerttemberg;
use umulmrum\Holiday\Provider\Germany\Bavaria;
use umulmrum\Holiday\Provider\Germany\Berlin;
use umulmrum\Holiday\Provider\Germany\Brandenburg;
use umulmrum\Holiday\Provider\Germany\Bremen;
use umulmrum\Holiday\Provider\Germany\GermanyHolidayInitializer;
use umulmrum\Holiday\Provider\Germany\Germany;
use umulmrum\Holiday\Provider\Germany\Hamburg;
use umulmrum\Holiday\Provider\Germany\Hesse;
use umulmrum\Holiday\Provider\Germany\MecklenburgVorpommern;
use umulmrum\Holiday\Provider\Germany\LowerSaxony;
use umulmrum\Holiday\Provider\Germany\NorthRhineWestphalia;
use umulmrum\Holiday\Provider\Germany\RhinelandPalatinate;
use umulmrum\Holiday\Provider\Germany\Saarland;
use umulmrum\Holiday\Provider\Germany\SaxonyAnhalt;
use umulmrum\Holiday\Provider\Germany\Saxony;
use umulmrum\Holiday\Provider\Germany\SchleswigHolstein;
use umulmrum\Holiday\Provider\Germany\Thuringia;

class HolidayCalculatorGermanyTest extends AbstractHolidayCalculatorTest
{
    /**
     * {@inheritdoc}
     */
    protected function getHolidayInitializer()
    {
        return new GermanyHolidayInitializer();
    }

    /**
     * {@inheritdoc}
     */
    public function getData()
    {
        return [
            [
                1970,
                Germany::ID,
                [
                    '1970-01-01',
                    '1970-03-27',
                    '1970-03-29',
                    '1970-03-30',
                    '1970-05-01',
                    '1970-05-07',
                    '1970-05-17',
                    '1970-05-18',
                    '1970-06-17',
                    '1970-10-31',
                    '1970-11-18',
                    '1970-12-25',
                    '1970-12-26',
                ],
            ],
            [
                2019,
                Germany::ID,
                [
                    '2019-01-01',
                    '2019-04-19',
                    '2019-04-21',
                    '2019-04-22',
                    '2019-05-01',
                    '2019-05-30',
                    '2019-06-09',
                    '2019-06-10',
                    '2019-10-03',
                    '2019-10-31',
                    '2019-11-20',
                    '2019-12-25',
                    '2019-12-26',
                ],
            ],
            [
                2009,
                BadenWuerttemberg::ID,
                [
                    '2009-01-01',
                    '2009-01-06',
                    '2009-04-10',
                    '2009-04-12',
                    '2009-04-13',
                    '2009-05-01',
                    '2009-05-21',
                    '2009-05-31',
                    '2009-06-01',
                    '2009-06-11',
                    '2009-10-03',
                    '2009-10-31',
                    '2009-11-01',
                    '2009-11-18',
                    '2009-12-25',
                    '2009-12-26',
                ],
            ],
            [
                2013,
                BadenWuerttemberg::ID,
                [
                    '2013-01-01',
                    '2013-01-06',
                    '2013-03-29',
                    '2013-03-31',
                    '2013-04-01',
                    '2013-05-01',
                    '2013-05-09',
                    '2013-05-19',
                    '2013-05-20',
                    '2013-05-30',
                    '2013-10-03',
                    '2013-10-31',
                    '2013-11-01',
                    '2013-11-20',
                    '2013-12-25',
                    '2013-12-26',
                ],
            ],
            [
                2016,
               BadenWuerttemberg::ID,
                [
                    '2016-01-01',
                    '2016-01-06',
                    '2016-03-25',
                    '2016-03-27',
                    '2016-03-28',
                    '2016-05-01',
                    '2016-05-05',
                    '2016-05-15',
                    '2016-05-16',
                    '2016-05-26',
                    '2016-10-03',
                    '2016-10-31',
                    '2016-11-01',
                    '2016-11-16',
                    '2016-12-25',
                    '2016-12-26',
                ],
            ],
            [
                2016,
                Bavaria::ID,
                [
                    '2016-01-01',
                    '2016-01-06',
                    '2016-03-25',
                    '2016-03-27',
                    '2016-03-28',
                    '2016-05-01',
                    '2016-05-05',
                    '2016-05-15',
                    '2016-05-16',
                    '2016-05-26',
                    '2016-08-08',
                    '2016-08-15',
                    '2016-10-03',
                    '2016-10-31',
                    '2016-11-01',
                    '2016-11-16',
                    '2016-12-25',
                    '2016-12-26',
                ],
            ],
            [
                2018,
                Berlin::ID,
                [
                    '2018-01-01',
                    '2018-03-30',
                    '2018-04-01',
                    '2018-04-02',
                    '2018-05-01',
                    '2018-05-10',
                    '2018-05-20',
                    '2018-05-21',
                    '2018-10-03',
                    '2018-10-31',
                    '2018-11-21',
                    '2018-12-25',
                    '2018-12-26',
                ],
            ],
            [
                2018,
                Brandenburg::ID,
                [
                    '2018-01-01',
                    '2018-03-30',
                    '2018-04-01',
                    '2018-04-02',
                    '2018-05-01',
                    '2018-05-10',
                    '2018-05-20',
                    '2018-05-21',
                    '2018-10-03',
                    '2018-10-31',
                    '2018-11-21',
                    '2018-12-25',
                    '2018-12-26',
                ],
            ],
            [
                2019,
                Bremen::ID,
                [
                    '2019-01-01',
                    '2019-04-19',
                    '2019-04-21',
                    '2019-04-22',
                    '2019-05-01',
                    '2019-05-30',
                    '2019-06-09',
                    '2019-06-10',
                    '2019-10-03',
                    '2019-10-31',
                    '2019-11-20',
                    '2019-12-25',
                    '2019-12-26',
                ],
            ],
            [
                2019,
                Hamburg::ID,
                [
                    '2019-01-01',
                    '2019-04-19',
                    '2019-04-21',
                    '2019-04-22',
                    '2019-05-01',
                    '2019-05-30',
                    '2019-06-09',
                    '2019-06-10',
                    '2019-10-03',
                    '2019-10-31',
                    '2019-11-20',
                    '2019-12-25',
                    '2019-12-26',
                ],
            ],
            [
                2016,
                Hesse::ID,
                [
                    '2016-01-01',
                    '2016-01-03',
                    '2016-01-10',
                    '2016-01-17',
                    '2016-01-24',
                    '2016-01-31',
                    '2016-02-07',
                    '2016-02-14',
                    '2016-02-21',
                    '2016-02-28',
                    '2016-03-06',
                    '2016-03-13',
                    '2016-03-20',
                    '2016-03-25',
                    '2016-03-27',
                    '2016-03-27',
                    '2016-03-28',
                    '2016-04-03',
                    '2016-04-10',
                    '2016-04-17',
                    '2016-04-24',
                    '2016-05-01',
                    '2016-05-01',
                    '2016-05-05',
                    '2016-05-08',
                    '2016-05-15',
                    '2016-05-15',
                    '2016-05-16',
                    '2016-05-22',
                    '2016-05-26',
                    '2016-05-29',
                    '2016-06-05',
                    '2016-06-12',
                    '2016-06-19',
                    '2016-06-26',
                    '2016-07-03',
                    '2016-07-10',
                    '2016-07-17',
                    '2016-07-24',
                    '2016-07-31',
                    '2016-08-07',
                    '2016-08-14',
                    '2016-08-21',
                    '2016-08-28',
                    '2016-09-04',
                    '2016-09-11',
                    '2016-09-18',
                    '2016-09-25',
                    '2016-10-02',
                    '2016-10-03',
                    '2016-10-09',
                    '2016-10-16',
                    '2016-10-23',
                    '2016-10-30',
                    '2016-10-31',
                    '2016-11-06',
                    '2016-11-13',
                    '2016-11-16',
                    '2016-11-20',
                    '2016-11-27',
                    '2016-12-04',
                    '2016-12-11',
                    '2016-12-18',
                    '2016-12-25',
                    '2016-12-25',
                    '2016-12-26',
                ],
            ],
            [
                2020,
                MecklenburgVorpommern::ID,
                [
                    '2020-01-01',
                    '2020-04-10',
                    '2020-04-12',
                    '2020-04-13',
                    '2020-05-01',
                    '2020-05-21',
                    '2020-05-31',
                    '2020-06-01',
                    '2020-10-03',
                    '2020-10-31',
                    '2020-11-18',
                    '2020-12-25',
                    '2020-12-26',
                ],
            ],
            [
                2021,
                LowerSaxony::ID,
                [
                    '2021-01-01',
                    '2021-04-02',
                    '2021-04-04',
                    '2021-04-05',
                    '2021-05-01',
                    '2021-05-13',
                    '2021-05-23',
                    '2021-05-24',
                    '2021-10-03',
                    '2021-10-31',
                    '2021-11-17',
                    '2021-12-25',
                    '2021-12-26',
                ],
            ],
            [
                2022,
                NorthRhineWestphalia::ID,
                [
                    '2022-01-01',
                    '2022-04-15',
                    '2022-04-17',
                    '2022-04-18',
                    '2022-05-01',
                    '2022-05-26',
                    '2022-06-05',
                    '2022-06-06',
                    '2022-06-16',
                    '2022-10-03',
                    '2022-10-31',
                    '2022-11-01',
                    '2022-11-16',
                    '2022-12-25',
                    '2022-12-26',
                ],
            ],
            [
                2023,
                RhinelandPalatinate::ID,
                [
                    '2023-01-01',
                    '2023-04-07',
                    '2023-04-09',
                    '2023-04-10',
                    '2023-05-01',
                    '2023-05-18',
                    '2023-05-28',
                    '2023-05-29',
                    '2023-06-08',
                    '2023-10-03',
                    '2023-10-31',
                    '2023-11-01',
                    '2023-11-22',
                    '2023-12-25',
                    '2023-12-26',
                ],
            ],
            [
                2024,
                Saarland::ID,
                [
                    '2024-01-01',
                    '2024-03-29',
                    '2024-03-31',
                    '2024-04-01',
                    '2024-05-01',
                    '2024-05-09',
                    '2024-05-19',
                    '2024-05-20',
                    '2024-05-30',
                    '2024-08-15',
                    '2024-10-03',
                    '2024-10-31',
                    '2024-11-01',
                    '2024-11-20',
                    '2024-12-25',
                    '2024-12-26',
                ],
            ],
            [
                2016,
                Saxony::ID,
                [
                    '2016-01-01',
                    '2016-03-25',
                    '2016-03-27',
                    '2016-03-28',
                    '2016-05-01',
                    '2016-05-05',
                    '2016-05-15',
                    '2016-05-16',
                    '2016-05-26',
                    '2016-10-03',
                    '2016-10-31',
                    '2016-11-16',
                    '2016-12-25',
                    '2016-12-26',
                ],
            ],
            [
                2017,
                Saxony::ID,
                [
                    '2017-01-01',
                    '2017-04-14',
                    '2017-04-16',
                    '2017-04-17',
                    '2017-05-01',
                    '2017-05-25',
                    '2017-06-04',
                    '2017-06-05',
                    '2017-06-15',
                    '2017-10-03',
                    '2017-10-31',
                    '2017-11-22',
                    '2017-12-25',
                    '2017-12-26',
                ],
            ],
            [
                2025,
                SaxonyAnhalt::ID,
                [
                    '2025-01-01',
                    '2025-01-06',
                    '2025-04-18',
                    '2025-04-20',
                    '2025-04-21',
                    '2025-05-01',
                    '2025-05-29',
                    '2025-06-08',
                    '2025-06-09',
                    '2025-10-03',
                    '2025-10-31',
                    '2025-11-19',
                    '2025-12-25',
                    '2025-12-26',
                ],
            ],
            [
                2019,
                SchleswigHolstein::ID,
                [
                    '2019-01-01',
                    '2019-04-19',
                    '2019-04-21',
                    '2019-04-22',
                    '2019-05-01',
                    '2019-05-30',
                    '2019-06-09',
                    '2019-06-10',
                    '2019-10-03',
                    '2019-10-31',
                    '2019-11-20',
                    '2019-12-25',
                    '2019-12-26',
                ],
            ],
            [
                2025,
                Thuringia::ID,
                [
                    '2025-01-01',
                    '2025-04-18',
                    '2025-04-20',
                    '2025-04-21',
                    '2025-05-01',
                    '2025-05-29',
                    '2025-06-08',
                    '2025-06-09',
                    '2025-06-19',
                    '2025-10-03',
                    '2025-10-31',
                    '2025-11-19',
                    '2025-12-25',
                    '2025-12-26',
                ],
            ],
        ];
    }

    /**
     * @test
     */
    public function it_computes_the_correct_holidays_if_manually_initialized()
    {
        $this->givenAHolidayCalculatorWithManualInitialization();
        $this->whenICallCalculateHolidaysForYear(2019, Germany::ID);
        $this->thenTheCorrectHolidaysShouldBeCalculated([
            '2019-01-01',
            '2019-04-19',
            '2019-04-21',
            '2019-04-22',
            '2019-05-01',
            '2019-05-30',
            '2019-06-09',
            '2019-06-10',
            '2019-10-03',
            '2019-10-31',
            '2019-11-20',
            '2019-12-25',
            '2019-12-26',
        ]);
    }

    private function givenAHolidayCalculatorWithManualInitialization()
    {
        $this->holidayCalculator = new HolidayCalculator();
        $this->holidayCalculator->addHolidayProvider(new Germany());
    }
}
